{"componentChunkName":"component---src-templates-blog-post-js","path":"/pyenv-venv-virtual-environment/","result":{"data":{"site":{"siteMetadata":{"title":"NARAZUKE","author":[{"name":"nozzle","summary":"who lives in gummaken.","social":{"github":"nozzlex3"}},{"name":"konnyaku","summary":"who is known as Siege Sukosuko Samurai.","social":{"github":"wabetarou"}}]}},"markdownRemark":{"id":"b576c0f4-25d2-5ec1-9e35-d30ffe71f626","excerpt":"pyenv と venv の違い pyenv は python のバージョンの使い分け。 (e.g. python 2.7.13 と python 3.9.0) venv は python のパッケージの使い分け。 (e.g. numpy を使う環境 と numpy いらない環境) pyenv の導入 python…","html":"<h2>pyenv と venv の違い</h2>\n<p>pyenv は python のバージョンの使い分け。 (e.g. python 2.7.13 と python 3.9.0)<br>\nvenv は python のパッケージの使い分け。 (e.g. numpy を使う環境 と numpy いらない環境)</p>\n<h2>pyenv の導入</h2>\n<h3>python のバージョン確認</h3>\n<pre><code class=\"language-bash\">python -V\n</code></pre>\n<p>僕の場合、2.7.13 でした。これから pyenv で python3.x 系と自由に切り替えられるようにしよう。</p>\n<h3>導入前に必要なパッケージの導入</h3>\n<pre><code class=\"language-bash\">sudo apt install build-essential libbz2-dev libdb-dev libreadline-dev libffi-dev libgdbm-dev liblzma-dev libncursesw5-dev libsqlite3-dev libssl-dev zlib1g-dev uuid-dev tk-dev\n</code></pre>\n<p>正直どれがなんだか分からないけど、とにかく<code>libffi-dev</code>は忘れずにインストールしよう。<br>これが無いと venv の作業でエラーを吐きます。</p>\n<h3>pyenv のインストール</h3>\n<pre><code class=\"language-bash\">git clone https://github.com/pyenv/pyenv.git ~/.pyenv\npyenv versions # インストール可能なpythonのバージョンの確認\npyenv install 3.9.0  # 3.9.0が最新(2020/11/09)\n</code></pre>\n<p><strong>[注意] pyenv install 3.9.0 はめちゃめちゃ時間かかるから焦らないように</strong></p>\n<h3>pyenv の PATH を通す</h3>\n<p><code>.bash_profile</code>に以下の内容を追記しよう</p>\n<pre><code class=\"language-bash\">export PYENV_ROOT=\"$HOME/.pyenv\"\nexport PATH=\"$PYENV_ROOT/bin:$PATH\"\neval \"$(pyenv init -)\"\nif [ -f ~/.bashrc ] ; then\n      . ~/.bashrc\nfi\n</code></pre>\n<p><code>.bash_profile</code>はログイン時に実行。<br>\n<code>.bashrc</code>は bash が開かれる度に実行。</p>\n<p>最後の if 文で<code>bashrc</code>を読み込ませる。これが無いと、ssh したときに bash の色が無くなる。<br>\nbash の配色は<code>bashrc</code>に担われてるのだ。</p>\n<p>参考:<a href=\"https://www.suzu6.net/posts/31/\">ラズパイのセットアップから pyenv を使って Python3.6 環境を構築するまで</a><br>\n参考:<a href=\"https://qiita.com/magicant/items/d3bb7ea1192e63fba850\">本当に正しい .bashrc と .bash_profile の使ひ分け</a><br>\n参考:<a href=\"https://qiita.com/upnt/items/022c5fc916d8a289e326\">Ubuntu で色がなくなる理由と改善策</a></p>\n<h3>pyenv で 2.x と 3.x を行き来</h3>\n<pre><code class=\"language-bash\">python -V\n</code></pre>\n<p><code>python 2.7.13</code>と出るはず</p>\n<pre><code class=\"language-bash\">pyenv global 3.9.0\npython -V\n</code></pre>\n<p><code>python 3.9.0</code>と出るはず</p>\n<pre><code class=\"language-bash\">pyenv global system\n</code></pre>\n<p><code>python 2.7.13</code>と出るはず</p>\n<p>python2.x と 3.x が混在してるとき、python3.x を使いたいときは python3 とか pip3 とか書く必要があった。<br>\npyenv のおかげで、python と打つだけで python3 系が動くようになった。</p>\n<h2>venv の導入</h2>\n<h3>venv のインストール</h3>\n<p><strong>venv はインストールする必要がない</strong></p>\n<p>venv は python3.3 から標準機能になったため、pyenv で 3.9.0 を導入しているなら必要がない。</p>\n<h3>venv の仮想環境の作り方</h3>\n<p>仮想環境はプロジェクトごとに作られるから、まず作業したいディレクトリを作成して移動しよう。<br>\n移動したら次のコマンドを打つ。</p>\n<pre><code class=\"language-bash\">python -m venv .venv # [.venv]は適当なフォルダ名\n</code></pre>\n<p>これもちょっと時間がかかる。<br>\n仮想環境のフォルダに.venv と書くのは慣習的なもの。<br>\n<code>myenv</code>とかでもいいよ。</p>\n<h3>仮想環境の実行</h3>\n<pre><code class=\"language-bash\">source .venv/bin/activate\n</code></pre>\n<p>今まで <code>pi@raspberrypi</code> だったやつが、<code>(.venv) pi@raspberrypi</code> になってたら成功。</p>\n<h3>venv 環境下でのモジュールのインストール</h3>\n<pre><code class=\"language-bash\">python -m pip install numpy   #numpyのインストール\npip list    #インストールされているモジュールの表示\n</code></pre>\n<p>numpy がリストに加わってるはず。</p>\n<h3>仮想環境からの離脱</h3>\n<pre><code class=\"language-bash\">deactivate   # 仮想環境からの離脱\npip list\n</code></pre>\n<p>numpy がリストに<strong>無いはず。</strong><br>\nそれもそのはず、numpy は仮想環境.venv で導入したパッケージだからラズパイの python パッケージには加わっていないのだ。</p>\n<h3>トラブルシュート:ModuleNotFoundError :No module named '_ctypes'</h3>\n<p>numpy をインストールしてる途中で<code>\"ModuleNotFoundError :No module named '_ctypes'</code>と出ることがあった。 <code>libffi-dev</code>が無いと出るエラーらしい。しかし、私の場合、導入してもエラーが消えなかった。あれこれ調べたら、pyenv 導入前に libffi-dev がインストールされていないと駄目らしいと判明。</p>\n<p>参考:<a href=\"https://qiita.com/mynkit/items/f8a1a90b99efef4a08a3\">pipenv の install 時に、No module named '_ctypes'が発生する</a></p>\n<pre><code class=\"language-bash\">pyenv uninstall 3.9.0\nsudo apt install libffi-dev\npyenv install 3.9.0\n</code></pre>\n<p>このあとで numpy の導入を試してみよう。きっとうまくいく。</p>\n<p>参考:<a href=\"https://hibiki-press.tech/python/venv/4567\">【Python】venv を使った仮想環境の構築方法</a></p>","fields":{"slug":"/pyenv-venv-virtual-environment/"},"frontmatter":{"title":"pyenvとvenvで仮想環境構築 ラズパイ編","created":"2021-02-03T00:05","updated":"2021-02-15T18:06","description":"ラズパイでpythonの仮想環境を作ったときのメモ","tag":["python","raspberrypi"],"author":["nozzle"],"category":"tech"}},"previous":{"fields":{"slug":"/kon20210203/"},"frontmatter":{"title":"日記"}},"next":{"fields":{"slug":"/kon20210204/"},"frontmatter":{"title":"日記"}},"relatedPosts":{"totalCount":8,"edges":[{"node":{"fields":{"slug":"/trouble-shooting-moduleerror-ndef/"},"frontmatter":{"title":"nfcpyの実験中\"ModuleNotFoundError No module named 'ndef'が出た"}}},{"node":{"fields":{"slug":"/raspberrypi-setting-memo/"},"frontmatter":{"title":"ラズパイ環境設定メモ"}}},{"node":{"fields":{"slug":"/wordpress-setting/"},"frontmatter":{"title":"WordPress設定備忘録"}}},{"node":{"fields":{"slug":"/raspberrypi-static-ipaddress/"},"frontmatter":{"title":"ラズパイのIPアドレスを固定する方法"}}},{"node":{"fields":{"slug":"/raspberrypi-ssd-boot/"},"frontmatter":{"title":"SDカードなしでRaspberry Pi 4B を SSDでUSB bootする"}}},{"node":{"fields":{"slug":"/raspberrypi-google-drive/"},"frontmatter":{"title":"ラズパイでGoogle Driveを使う"}}},{"node":{"fields":{"slug":"/opencv-no-mudule/"},"frontmatter":{"title":"opencvのNotFoundeError"}}},{"node":{"fields":{"slug":"/pyenv-venv-virtual-environment/"},"frontmatter":{"title":"pyenvとvenvで仮想環境構築 ラズパイ編"}}}]}},"pageContext":{"id":"b576c0f4-25d2-5ec1-9e35-d30ffe71f626","previousPostId":"06b73d16-c4f5-54c9-b8f2-dbea4371b32b","nextPostId":"15f85175-e64c-596a-8e76-25dd56890834","category":"tech","tagList":["python","raspberrypi"]}},"staticQueryHashes":["3284037645","500847697"]}